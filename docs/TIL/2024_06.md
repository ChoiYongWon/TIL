# 2024. 06.

## 06. 02.

### Vercel, supabase 등 Serverless 기반 서비스에서 ColdStart 이슈 해결

서비스를 배포하고 사용률이 저조할 때 들어가면 로딩속도가 현저히 느려지는 이슈가 있었다.

https://youtube.com/shorts/DAFyH5Jf9ps

이는 서버가 꺼진상태에서 다시 부팅되는데 걸리는 시간 때문으로 ColdStart 이슈라고 한다.

30분동안 사용률이 없을 때 측정을 해본 결과 Time To First Byte가 1.38s, 영상 1에서 숫자를 불러오는 API 응답 속도가 8s가 나왔다.

그림 1.

그림 2.

반면, 10분 이내로 사용률이 존재할 때는  TTFB가 약 200ms, API가 약 300ms 정도 나왔다.

그림 3. 

그림 4.

Vercel에서도 자체적으로 [ColdStart 이슈를 해결하는 방법](https://vercel.com/guides/how-can-i-improve-serverless-function-lambda-cold-start-performance-on-vercel)을 제시한다.

여기서는 8가지 방법을 제시하는데, 그 중 과금을 안들이는 방법중 가장 현실적인 방법 3가지를 적용 시켜볼려고 한다.

- Use dynamic imports
- Prewarm your functions using cron jobs
- Choose smaller dependencies inside your functions

실제 서버를 배포해본 결과, 

<div class="img-container">
    <img class="img" src="https://github.com/ChoiYongWon/resume/assets/40623433/43b470ac-1c50-422f-be5d-fbcbb76945c8" alt=""/>
    <span class="caption">그림 1. Warm 상태의 Vercel TTFB.</span>
</div>

하지만 5분이 지난 이후 

(작성중...)